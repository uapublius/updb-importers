# UPDB Importers

- Hosts the UPDB [postgres database](db/)

- Contains source for [importers](src/importers/) that read, normalize, and insert reports into the database.
  - Parse dates using manual processing and chrono-node
  - Parse locations into {city, district, country, water, other}
    - Detect country codes from [list](https://github.com/annexare/Countries)
    - Detect province/state/district from [list](https://github.com/substack/provinces)
    - Detect water bodies from [list](src/lib/water-bodies.ts)
  - Detect media attachments in reports
  - Detect references in reports
  - Clean reports: detect and use old encodings, normalize html & plaintext line breaks and spaces, replace invisible/unusable ASCII/unicode characters.

- Houses [config file](server/postgrest.conf) for serving postgREST API from database.

## Data

The data to import is generated by the [updb-scrapers](https://github.com/uapublius/updb-scrapers) project.

## API

[Postgrest](https://postgrest.org) serves a RESTful API of the database. See `server/postgrest.conf`.
